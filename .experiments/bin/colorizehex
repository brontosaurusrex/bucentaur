#!/usr/bin/env bash
# Usage: echo "text" | colorizehex RRGGBB

# Require a color argument
if [[ -z "$1" ]]; then
  echo "Usage: echo \"boo\" | colorizehex RRGGBB" >&2
  exit 1
fi

# Let's make this into function,
# so it can be copy/pasted to other scripts
colorizehexfunc () {

    hex="${1#\#}"  # strip leading '#' if present

    # Validate 6-digit hex
    if [[ ! "$hex" =~ ^[0-9A-Fa-f]{6}$ ]]; then
      echo "Invalid color: must be 6 hex digits (e.g. FF00AA)" >&2
      exit 1
    fi

    # Convert to RGB
    r=$((16#${hex:0:2})); g=$((16#${hex:2:2})); b=$((16#${hex:4:2}))

    # Apply color to stdin text
    while IFS= read -r line; do
      printf "\033[38;2;%d;%d;%dm%s\033[0m\n" "$r" "$g" "$b" "$line"
    done

}

colorizehexfunc "$1"

