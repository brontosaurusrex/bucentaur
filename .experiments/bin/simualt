#!/bin/bash

# simualt

# simulate alt hold down until left mice is clicked

set -e

superecho () {
    (sleep "$1" && notify-send -t 1500 "$2" & echo "$2") &
}

# hold alt
xdotool keydown alt && superecho "0" "alt is on"

# wait for mouse left click before releasing
mouse="$(xinput --list | awk -F 'id=|\\[' '/mouse|Mouse/ {print $2}')"
mouse="${mouse//[[:space:]]}"

# https://stackoverflow.com/questions/44133590/how-to-detect-when-mouse-1-button-is-pressed-then-run-a-bash-script
while :; do
    state="$(xinput --query-state "$mouse")"
    #echo "$state" # debug
    # If any button is pressed, abort holding alt
    if [[ "$state" == *"=down"* ]]; then
    
        # depress alt
        xdotool keyup alt && superecho "0.5" "alt is off"
        exit
        
    fi

sleep .1s
done
