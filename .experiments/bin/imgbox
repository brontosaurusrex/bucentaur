#!/bin/bash

# imgbox 

# (brex & chatgpt 2024)
# Convert imgbox.com provided HTML into a more friendly version
# where thumbs link directly to images, echo it to stdout

# usage: 
# imgbox in.htm

input="$1"

# Ensure the input file exists
if [[ ! -f "$input" ]]; then
  echo "File not found: $input"
  exit 1
fi

# Extract URLs ending with .png or .jpg and process them
grep -oP '(?<=src=")[^"]*\.(png|jpg)' "$input" | while IFS= read -r line; do
    # Perform replacements to convert thumb URLs to full image URLs
    newline="${line/thumbs2/images2}"
    newline="${newline/_t./_o.}"

    # Output the modified HTML line
    echo "<a href=\"$newline\" target=\"_blank\"><img src=\"$line\" alt=\"image\"></a>"
done
