#!/bin/bash

# pipeScreenfetch

# call from .config/openbox/menu.xml like
#        <menu id="screenfetch" label="screenfetch" execute="pipeScreenfetch" />

# header
header () {
cat << HEAD
<openbox_pipe_menu>
HEAD
}

# footer
footer () {
cat << FOOT
</openbox_pipe_menu>
FOOT
}

xmlescape () {
    echo "$@" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g; s/"/\&quot;/g; s/'"'"'/\&#39;/g; s/^[ \t]*//;s/[ \t]*$//'
}

# checks critical
command -v screenfetch >/dev/null 2>&1 || { header; echo "<item label=\"Horrible error, I need screenfetch installed.\" />"; footer ; exit 1; }

header
# items loop over lines
screenfetch -nN -d "-host;-shell" | while read -r line 
do 

    #line=$(xmlescape "$line")
    echo "<item label=\"$line\" />"

done
footer
